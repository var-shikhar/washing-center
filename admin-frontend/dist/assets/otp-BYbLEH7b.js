import{r as a,j as t,d as M,c as K,B as O,b as H,R as L,t as U}from"./index-Dk9JA_Lc.js";import{C as G}from"./card-DVMURCxI.js";import{F as X,a as q,b as z,d as W,e as Z}from"./form-CZLONr-s.js";import{I as J}from"./input-DrkxjiK5.js";import{S as Q}from"./separator-Uw-iM8ec.js";import{z as T,u as Y,t as ee}from"./index-yN_4ul2K.js";const _=a.createContext(!1),V=a.forwardRef(({className:c,children:o,...g},l)=>{const{defaultValue:u,value:y,onChange:f,onComplete:m,onIncomplete:p,placeholder:R="○",type:j="alphanumeric",name:h,form:w,otp:d=!1,mask:v=!1,disabled:C=!1,readOnly:E=!1,autoFocus:A=!1,ariaLabel:I="",...S}=g,k=se(o),b=re(o),{pins:n,pinValue:e,refMap:r,...s}=ne({value:y,defaultValue:u,placeholder:R,type:j,length:b,readOnly:E});a.useEffect(()=>{f&&f(e)},[f,e]);const i=a.useRef(e.length===b);a.useEffect(()=>{e.length===b&&i.current===!1&&(i.current=!0,m&&m(e)),e.length!==b&&i.current===!0&&(i.current=!1,p&&p(e))},[b,m,p,e,n,y]),a.useEffect(()=>{if(!A)return;const F=r==null?void 0:r.get(0);F&&F.focus()},[A,r]);const P=a.useRef(0);let D=0;const $=k.map(F=>{if(F.type===B){const N=D;return D=D+1,a.cloneElement(F,{name:h,inputKey:`input-${N}`,value:b>N?n[N]:"",onChange:x=>s.handleChange(x,N),onFocus:x=>s.handleFocus(x,N),onBlur:()=>s.handleBlur(N),onKeyDown:x=>s.handleKeyDown(x,N),onPaste:x=>s.handlePaste(x),placeholder:R,type:j,mask:v,autoComplete:d?"one-time-code":"off",disabled:C,readOnly:E,"aria-label":I||`Pin input ${D} of ${b}`,ref:x=>{x?r==null||r.set(N,x):r==null||r.delete(N)}})}return P.current=P.current+1,F});return t.jsx(_.Provider,{value:!0,children:t.jsxs("div",{ref:l,"aria-label":"Pin Input",className:c,...S,children:[$,t.jsx("input",{type:"hidden",name:h,form:w,value:e})]})})});V.displayName="PinInput";const te=({className:c,component:o,...g},l)=>{const{mask:u,type:y,inputKey:f,...m}=g;if(!a.useContext(_))throw new Error(`PinInputField must be used within ${V.displayName}.`);const R=o||"input";return t.jsx(R,{ref:l,type:u?"password":y==="numeric"?"tel":"text",inputMode:y==="numeric"?"numeric":"text",className:M("size-10 text-center",c),...m},f)},B=a.forwardRef(te),ne=({value:c,defaultValue:o,placeholder:g,type:l,length:u,readOnly:y})=>{const f=a.useMemo(()=>Array.from({length:u},(n,e)=>o?o.charAt(e):c?c.charAt(e):""),[o,u,c]),[m,p]=a.useState(f),R=m.join("").trim();a.useEffect(()=>{p(f)},[f]);const j=a.useRef(null);function h(){return j.current||(j.current=new Map),j.current}function w(n){const e=h();return e==null?void 0:e.get(n)}function d(n){const e=w(n);e&&(e.focus(),e.placeholder="")}function v(n,e){n.target.select(),d(e)}function C(n){const e=w(n);e&&(e.placeholder=g)}function E(n,e){const r=w(e);r&&(r.value=n),p(s=>s.map((i,P)=>P===e?n:i))}function A(n){return(l==="alphanumeric"?/^[a-zA-Z0-9]+$/i:/^[0-9]+$/).test(n)}const I=a.useRef(null);function S(n,e){const r=n.target.value,s=I.current,i=s&&s.length===u?s.charAt(u-1):r.slice(-1);A(i)&&(E(i,e),I.current=null,r.length>0&&d(e+1))}function k(n){n.preventDefault();const e=n.clipboardData.getData("text/plain").replace(/[\n\r\s]+/g,""),r=e.split("").slice(0,u);if(r.every(i=>A(i))){for(let i=0;i<u;i++)i<r.length&&E(r[i],i);I.current=e,d(r.length<u?r.length:u-1)}}function b(n,e){const{ctrlKey:r,key:s,shiftKey:i,metaKey:P}=n;l==="numeric"&&(!(s==="Backspace"||s==="Tab"||s==="Control"||s==="Delete"||r&&s==="v"||P&&s==="v"||!Number.isNaN(Number(s)))||y)&&n.preventDefault(),s==="ArrowLeft"||i&&s==="Tab"?(n.preventDefault(),d(e-1)):s==="ArrowRight"||s==="Tab"||s===" "?(n.preventDefault(),d(e+1)):s==="Delete"?n.preventDefault():s==="Backspace"&&(n.preventDefault(),E("",e),n.target.value===""&&d(e-1))}return{pins:m,pinValue:R,refMap:h(),handleFocus:v,handleBlur:C,handleChange:S,handlePaste:k,handleKeyDown:b}},se=c=>a.Children.toArray(c).filter(o=>{if(a.isValidElement(o))return a.isValidElement(o);throw new Error(`${V.displayName} contains invalid children.`)}),re=c=>a.Children.toArray(c).filter(o=>{if(a.isValidElement(o)&&o.type===B)return a.isValidElement(o)}).length,ae=T.object({isMaster:T.boolean(),otp:T.string().min(1,{message:"Please enter your otp code."})});function oe({className:c,submissionURL:o,submissionType:g="put",successMessage:l="OTP has verified successfully!",successFn:u,...y}){const{HandlePostRequest:f}=K(),[m,p]=a.useState(!1),[R,j]=a.useState(!0),h=Y({resolver:ee(ae),defaultValues:{otp:"",isMaster:!0}});async function w(d){p(!0);const v=await f({data:d,route:o,type:g,toastDescription:l});p(!1),(v==null?void 0:v.status)===200&&u(v.data)}return t.jsx("div",{className:M("grid gap-6",c),...y,children:t.jsx(X,{...h,children:t.jsx("form",{onSubmit:h.handleSubmit(w),children:t.jsxs("div",{className:"grid gap-2",children:[t.jsx(q,{control:h.control,name:"otp",render:({field:d})=>t.jsxs(z,{className:"space-y-1",children:[t.jsx(W,{children:t.jsx(V,{...d,className:"flex h-10 justify-between",onComplete:()=>j(!1),onIncomplete:()=>j(!0),children:Array.from({length:7},(v,C)=>C===3?t.jsx(Q,{orientation:"vertical"},C):t.jsx(B,{component:J,className:`${h.getFieldState("otp").invalid?"border-red-500":""}`},C))})}),t.jsx(Z,{})]})}),t.jsx(O,{className:"mt-2",disabled:R,loading:m,children:"Verify"})]})})})})}function me(){const{HandleGetRequest:c}=K(),o=H();async function g(){const l=await c({route:L.commonRegisterRoute});(l==null?void 0:l.status)===200&&U({title:"Success",description:"OTP has been reshared successfully!"})}return t.jsx(t.Fragment,{children:t.jsx("div",{className:"container grid h-svh flex-col items-center justify-center bg-primary-foreground lg:max-w-none lg:px-0",children:t.jsxs("div",{className:"mx-auto flex w-full flex-col justify-center space-y-2 sm:w-[480px] lg:p-8",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-center",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2 h-6 w-6",children:t.jsx("path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3"})}),t.jsx("h1",{className:"text-xl font-medium",children:"Washing Center  "})]}),t.jsxs(G,{className:"p-6",children:[t.jsxs("div",{className:"mb-2 flex flex-col space-y-2 text-left",children:[t.jsx("h1",{className:"text-md font-semibold tracking-tight",children:"Two-factor Authentication"}),t.jsxs("p",{className:"text-sm text-muted-foreground",children:["Please enter the authentication code. ",t.jsx("br",{})," We have sent the authentication code to your email."]})]}),t.jsx(oe,{submissionURL:L.commonRegisterRoute,submissionType:"put",successMessage:"Account has activated successfully!",successFn:l=>{console.log(l),o("../")}}),t.jsxs("p",{className:"mt-4 px-8 text-center text-sm text-muted-foreground",children:["Haven't received it?"," ","  ",t.jsx("b",{onClick:g,className:"underline underline-offset-4 hover:text-primary",children:"Resend a new code."}),"."]})]})]})})})}export{me as default};
