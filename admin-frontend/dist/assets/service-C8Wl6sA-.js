import{b as k,a as L,c as C,r as s,R as N,j as e,d as T,B as S}from"./index-1OMG5jF6.js";import{a as I,C as w,I as R}from"./customTooltip-CCaoKfbQ.js";import{T as E,U as A}from"./user-nav-1b8vRZui.js";import{I as V}from"./input-BiIz55iz.js";import{S as q}from"./separator-BC39n2JN.js";import{L as D}from"./dropdown-menu-D1FGZesl.js";import{u as F,z as y,t as P}from"./index-CKQsl4b0.js";import{I as H}from"./IconEdit-DxG3TVp0.js";import"./tooltip-LVZlHhLP.js";const U=()=>{const c=k(),{isLoggedIn:d}=L(),{HandleGetRequest:x,HandlePostRequest:a}=C(),[r,o]=s.useState(!0),[h,n]=s.useState(""),[j,u]=s.useState(!1),[t,m]=s.useState([]),[b,g]=s.useState([]);s.useLayoutEffect(()=>{d||c("../auth/sign-in")},[d]),s.useEffect(()=>{r&&v(N.commonServiceRoute)},[r]),s.useEffect(()=>{let i=t;(t==null?void 0:t.length)>0&&h!==""&&(i=i.filter(p=>p.name.toLowerCase().includes(h.toLowerCase()))),s.startTransition(()=>g(i))},[h,t]);async function v(i){const p=await x({route:i});(p==null?void 0:p.status)===200&&s.startTransition(()=>{o(!1),m(p.data)})}function l(){s.startTransition(()=>{o(!0),u(!1)})}async function f(i){const p=await a({data:{serviceID:i},route:`${N.commonServiceRoute}/${i}`,type:"delete",toastDescription:"Service has deleted successfully"});(p==null?void 0:p.status)===200&&l()}return{filteredList:b,searchTerm:h,modalToggle:j,setModalToggle:u,setSearchTerm:n,handleServiceDeletion:f,handleConfirmation:l}},$=(c="")=>{const d=k(),{isLoggedIn:x}=L(),{HandleGetRequest:a,HandlePostRequest:r}=C(),[o,h]=s.useState({initial:c!=="",data:!0}),[n,j]=s.useState({categoryList:[],vehicleList:[]}),[u,t]=s.useState({id:c??"",serviceName:"",categoryID:"",vehicleID:"",serviceDescription:""});s.useLayoutEffect(()=>{x||d("../auth/sign-in")},[x]),s.useEffect(()=>{o.initial&&m(`${N.commonServiceRoute}/${c}`,"initial"),o.data&&m(N.getAPIServiceRoute,"data")},[o.data,o.initial,c]);async function m(g,v){const l=await a({route:g});(l==null?void 0:l.status)===200&&s.startTransition(()=>{h(f=>({...f,[v]:!1})),v==="initial"?t(f=>({...f,...l.data})):j(f=>({...f,...l.data}))})}async function b(g,v){const l=await r({data:g,route:N.commonServiceRoute,type:c===""?"post":"put",toastDescription:`Service Item has ${c===""?"created":"updated"} successfully!`});(l==null?void 0:l.status)===200&&v()}return{defaultValues:u,apiData:n,handleFormSubmission:b}},G=y.object({id:y.string().optional(),serviceName:y.string().min(2,{message:"Service Name should have at least 2 characters"}),categoryID:y.string(),vehicleID:y.string(),serviceDescription:y.string().min(2,{message:"Service Description should have at least 2 characters"})});function z({className:c,formID:d,handleConfirmation:x,...a}){var l,f;const{apiData:r,defaultValues:o,handleFormSubmission:h}=$(d),{register:n,handleSubmit:j,reset:u,formState:{errors:t,isValid:m,isDirty:b,isSubmitting:g}}=F({resolver:P(G),defaultValues:o,mode:"onChange"});s.useEffect(()=>{o&&u(o)},[o,u]);async function v(i){h(i,x)}return e.jsx("div",{className:T("grid gap-6",c),...a,children:e.jsxs("form",{onSubmit:j(v),className:"p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-center",children:"Service Information"}),e.jsxs("div",{className:"mb-4 flex flex-col lg:flex-row lg:space-x-4",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Select Vehicle Type"}),e.jsxs("select",{...n("vehicleID"),className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full",children:[e.jsx("option",{value:"",children:"Select Vehicle"}),(l=r==null?void 0:r.vehicleList)==null?void 0:l.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]}),e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Select Category"}),e.jsxs("select",{...n("categoryID"),className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full",children:[e.jsx("option",{value:"",children:"Select Category"}),(f=r==null?void 0:r.categoryList)==null?void 0:f.map(i=>e.jsx("option",{value:i.id,children:i.name},i.id))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Service Name"}),e.jsx("input",{type:"text",...n("serviceName"),placeholder:"(i.e. 150)",className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full"}),t.serviceName&&e.jsx("p",{className:"text-red-600 text-sm",children:t.serviceName.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Service Description"}),e.jsx("textarea",{rows:5,...n("serviceDescription"),placeholder:"(i.e. 150)",className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full"}),t.serviceDescription&&e.jsx("p",{className:"text-red-600 text-sm",children:t.serviceDescription.message})]}),e.jsx(S,{className:"mt-2 w-full",type:"submit",disabled:!b||!m||g,children:d===""?"Create New Service":"Update Service Details"})]})})}function _(){const{filteredList:c,modalToggle:d,searchTerm:x,setSearchTerm:a,setModalToggle:r,handleServiceDeletion:o,handleConfirmation:h}=U(),[n,j]=s.useState({id:"",name:"",type:"",title:""});function u(t,m,b,g){s.startTransition(()=>{r(!d),j({id:t,name:m,type:g,title:b})})}return e.jsxs(D,{fixed:!0,children:[e.jsx(D.Header,{children:e.jsxs("div",{className:"flex w-full items-center justify-end space-x-4",children:[e.jsx(E,{}),e.jsx(A,{})]})}),e.jsxs(D.Body,{className:"flex flex-col",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Service List Panel"}),e.jsx("p",{className:"text-muted-foreground",children:"View and create services items at one place."})]}),e.jsxs("div",{className:"my-4 flex items-end justify-between sm:items-center",children:[e.jsx(V,{placeholder:"Filter service by name...",className:"h-9 w-40 lg:w-[250px]",value:x,onChange:t=>a(t.target.value)}),e.jsx(S,{type:"button",onClick:()=>u("","","Add New Service","Add"),children:"Add New Service"})]}),e.jsx(q,{className:"shadow"}),e.jsx(B,{list:c,handleDelete:(t,m)=>u(t,m,"Delete Service","Delete"),handleEdit:(t,m)=>u(t,m,"Edit Service","Edit")}),e.jsx(I,{isOpen:d,setISOpen:r,hasTrigger:!1,customWidth:"20vw",title:n.title,contentNode:e.jsx("div",{children:n.type==="Delete"?e.jsxs("div",{children:[e.jsxs("div",{children:["Are you sure you want to ",n.type," ",n.name," ?"]}),e.jsxs("div",{className:"flex justify-end gap-2 sm:mt-5 sm:me-5 my-2",children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Close"}),e.jsx(S,{type:"button",onClick:()=>o(n.id),children:"Delete Service"})]})]}):e.jsx(z,{formID:n.id,handleConfirmation:h})})})]})]})}const B=({list:c,handleEdit:d,handleDelete:x})=>e.jsx("div",{className:"overflow-x-auto overscroll-y-none",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 rounded-s py-3 font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6 text-center",children:"S.No."}),e.jsx("th",{className:"px-2 py-3 bg-black",children:e.jsx("div",{className:"text-left font-bold text-xs text-white  uppercase tracking-wider w-max",children:"Service Name"})}),e.jsx("th",{className:"px-2 py-3 bg-black",children:e.jsx("div",{className:"font-bold text-xs text-white  uppercase tracking-wider w-max",children:"Service Category"})}),e.jsx("th",{className:"px-2 py-3 bg-black",children:e.jsx("div",{className:"text-center font-bold text-xs text-white  uppercase tracking-wider w-max",children:"Service Vehicle"})}),e.jsx("th",{className:"px-2 py-3 bg-black",children:e.jsx("div",{className:"text-left font-bold text-xs text-white  uppercase tracking-wider w-max",children:"Service Description"})}),e.jsx("th",{className:"px-2 rounded-e py-3 font-bold text-xs text-white text-center bg-black uppercase tracking-wider md:px-6",children:"Interact"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c==null?void 0:c.map((a,r)=>e.jsxs("tr",{className:"bg-gray-50 text-gray-900 hover:bg-gray-100",children:[e.jsx("td",{className:"py-3 text-center relative",children:r+1}),e.jsx("td",{className:"py-3",children:a.name}),e.jsx("td",{className:"py-3",children:a.categoryName}),e.jsx("td",{className:"py-3 text-center",children:a.vehicleName}),e.jsx("td",{className:"py-3",children:e.jsx("div",{className:"text-center w-28 truncate",children:e.jsx(w,{content:a.serviceDescription,trigger:e.jsx("div",{className:"w-[100%] truncate",children:a.serviceDescription})})})}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(w,{content:"Edit Service",trigger:e.jsx(H,{className:"cursor-pointer rounded-md border p-1 bg-slate-400 hover:bg-slate-600 transition-all fade-in-100 text-black hover:text-white",size:"25",onClick:()=>d(a.id,a.name)})}),e.jsx(w,{content:"Delete Service",trigger:e.jsx(R,{className:"cursor-pointer rounded-md border p-1 bg-slate-400 hover:bg-slate-600 transition-all fade-in-100 text-black hover:text-white",size:"25",onClick:()=>x(a.id,a.name)})})]})})]},a.id))})]})});export{_ as default};
