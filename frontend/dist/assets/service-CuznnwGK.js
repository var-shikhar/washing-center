import{c as W,b as Z,f as Y,u as J,r as t,R as L,j as e,d as X,B as K}from"./index-CIU13SRd.js";import{T as _,U as ee}from"./user-nav-B1o38MQH.js";import{D as se,a as te,b as ae,c as re,d as le}from"./dialog-DF1lKM7a.js";import{I as ie}from"./input-C8YPt6d3.js";import{S as ce,a as ne,b as de,c as oe,e as Q}from"./select-XvbIE4Hi.js";import{S as me}from"./separator-CorPt49m.js";import{L as R}from"./dropdown-menu-BsfwNUnl.js";import{u as ue,a as xe,z as h,t as pe}from"./index-Dl_JxZww.js";import{I as he}from"./IconSquareRoundedPlusFilled-BmA22oDs.js";import{C as F}from"./customTooltip-7V_NDDGm.js";import{I as fe,a as ge,b as be,c as ve,d as je,e as Ne}from"./IconTrash-D7bA92Vc.js";import{I as Se}from"./IconAdjustmentsHorizontal-BmrnOZ-i.js";import"./commonFn-D6AOWzB5.js";import"./index-CLgSpsmz.js";import"./index-MoP1YZUk.js";import"./index-025rV9oj.js";import"./index-C8YVdoZ3.js";import"./index-Bi5ksZmZ.js";import"./index-C9cin_b5.js";import"./index-D1y3U3Hq.js";import"./tooltip-C_xVJ_j6.js";/**
 * @license @tabler/icons-react v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ye=W("filled","square-rounded-minus-filled","IconSquareRoundedMinusFilled",[["path",{d:"M12 2l.324 .001l.318 .004l.616 .017l.299 .013l.579 .034l.553 .046c4.785 .464 6.732 2.411 7.196 7.196l.046 .553l.034 .579c.005 .098 .01 .198 .013 .299l.017 .616l.005 .642l-.005 .642l-.017 .616l-.013 .299l-.034 .579l-.046 .553c-.464 4.785 -2.411 6.732 -7.196 7.196l-.553 .046l-.579 .034c-.098 .005 -.198 .01 -.299 .013l-.616 .017l-.642 .005l-.642 -.005l-.616 -.017l-.299 -.013l-.579 -.034l-.553 -.046c-4.785 -.464 -6.732 -2.411 -7.196 -7.196l-.046 -.553l-.034 -.579a28.058 28.058 0 0 1 -.013 -.299l-.017 -.616c-.003 -.21 -.005 -.424 -.005 -.642l.001 -.324l.004 -.318l.017 -.616l.013 -.299l.034 -.579l.046 -.553c.464 -4.785 2.411 -6.732 7.196 -7.196l.553 -.046l.579 -.034c.098 -.005 .198 -.01 .299 -.013l.616 -.017c.21 -.003 .424 -.005 .642 -.005zm3 9h-6l-.117 .007a1 1 0 0 0 .117 1.993h6l.117 -.007a1 1 0 0 0 -.117 -1.993z",key:"svg-0"}]]);const we=()=>{const{selectedCenter:r}=Z(),m=Y(),{HandleGetRequest:b,HandlePostRequest:u}=J(),[s,n]=t.useState(!0),[C,j]=t.useState(!1),[S,f]=t.useState({title:"",id:""}),[y,x]=t.useState("ascending"),[v,l]=t.useState(""),[N,A]=t.useState([]),[p,c]=t.useState([]);t.useLayoutEffect(()=>{r||m("../center")},[r]),t.useEffect(()=>{s&&i(`${L.getServiceList}/${r}`)},[s,r]),t.useEffect(()=>{if((N==null?void 0:N.length)>0){let g=N.sort((d,k)=>{var T;return y==="ascending"?(T=d.serviceName)==null?void 0:T.localeCompare(k.serviceName):k.serviceName.localeCompare(d.serviceName)});v!==""&&(g=g.filter(d=>d.serviceName.toLowerCase().includes(v.toLowerCase()))),t.startTransition(()=>{c(g)})}},[y,v,N]);async function i(g){const d=await b({route:g});(d==null?void 0:d.status)===200&&t.startTransition(()=>{A(d.data),n(!1)})}async function w(g,d){const k=await u({route:`${L.commonServiceRoute}/${g}`,data:{serviceID:g,value:d},toastDescription:`Service has ${d?"activated":"de-activated"} successfully`,type:"put"});(k==null?void 0:k.status)===200&&P()}async function D(g){const d=await u({route:`${L.commonServiceRoute}/${g}`,data:{serviceID:g},toastDescription:"Service has deleted successfully",type:"delete"});(d==null?void 0:d.status)===200&&window.location.reload()}function P(){t.startTransition(()=>{n(!0)})}return{modalToggle:C,setModalToggle:j,selectedSort:y,setSelectedSort:x,searchTerm:v,setSearchTerm:l,modalData:S,setModalData:f,filteredList:p,handleConfirmation:P,handleServiceStatusUpdate:w,handleServiceDeletion:D}},Ce=(r="")=>{const{selectedCenter:m}=Z(),{HandleGetRequest:b,HandlePostRequest:u}=J(),s=Y(),[n,C]=t.useState({initial:r!=="",data:!0}),[j,S]=t.useState({categoryList:[],vehicleList:[],serviceList:[],filteredServiceList:[],addonServiceList:[],filteredAddonServiceList:[]}),[f,y]=t.useState({centerID:m??"",id:r,serviceID:"",price:0,discPrice:0,isCustomizable:!1,addons:[]}),[x,v]=t.useState({category:"",vehicle:""});t.useLayoutEffect(()=>{m||s("../center")},[m]),t.useEffect(()=>{n.initial&&l(`${L.commonServiceRoute}/${r}`,"initial"),n.data&&l(L.getAPIServiceForm,"data")},[n.data,n.initial,r]),t.useEffect(()=>{let p=j.serviceList,c=j.addonServiceList;p.length>0&&(x.vehicle!==""&&(p=p.filter(i=>i.vehicleID.toString()===x.vehicle.toString()),c=c.filter(i=>i.vehicleID.toString()===x.vehicle.toString())),x.category!==""&&(c=c.filter(i=>i.categoryID.toString()===x.category.toString())),t.startTransition(()=>{S(i=>({...i,filteredServiceList:p,filteredAddonServiceList:c}))}))},[x.category,x.vehicle,j.serviceList,j.addonServiceList]);async function l(p,c){const i=await b({route:p});(i==null?void 0:i.status)===200&&t.startTransition(()=>{C(w=>({...w,[c]:!1})),c==="initial"?y(w=>({...w,...i.data})):S(w=>({...w,...i.data}))})}async function N(p,c){const i=await u({data:p,route:L.commonServiceRoute,type:r===""?"post":"put",toastDescription:`Service has ${r===""?"created":"updated"} successfully!`});(i==null?void 0:i.status)===200&&c()}function A(p,c){t.startTransition(()=>{v(i=>({...i,[c]:p}))})}return{defaultValues:f,apiData:j,selectedFilters:x,handleFormSubmission:N,handleFilterChange:A}},ke=h.object({serviceID:h.string().min(2,{message:"Addon service ID should have at least 2 characters"}),price:h.number().min(5,{message:"Addon price must be at least 5"}),discPrice:h.number().min(5,{message:"Addon discounted price must be at least 5"})}),Ie=h.object({centerID:h.string(),id:h.string().optional(),serviceID:h.string().min(2,{message:"Service ID should have at least 2 characters"}),price:h.number(),discPrice:h.number(),isCustomizable:h.boolean().optional(),addons:h.array(ke).optional()}).superRefine((r,m)=>{var b;r.discPrice>=r.price&&m.addIssue({path:["discPrice"],message:"Discounted price must be lower than the service price",code:h.ZodIssueCode.custom}),(b=r.addons)==null||b.forEach((u,s)=>{u.discPrice>=u.price&&m.addIssue({path:["addons",s,"discPrice"],message:"Addon discounted price must be lower than the addon price",code:h.ZodIssueCode.custom})})});function Le({className:r,formID:m,handleConfirmation:b,...u}){var T,E;const{apiData:s,defaultValues:n,selectedFilters:C,handleFormSubmission:j,handleFilterChange:S}=Ce(m),{register:f,control:y,handleSubmit:x,reset:v,formState:{errors:l,isValid:N,isDirty:A,isSubmitting:p}}=ue({resolver:pe(Ie),defaultValues:n,mode:"onChange"}),{fields:c,append:i,remove:w}=xe({control:y,name:"addons"}),[D,P]=t.useState([]);t.useEffect(()=>{n&&v(n)},[n,v]);async function g(a){j(a,b)}const d=(a,o)=>{const z=[...D];z[o]=a,P(z)},k=a=>{w(a);const o=[...D];o.splice(a,1),P(o)};return e.jsx("div",{className:X("grid gap-6",r),...u,children:e.jsxs("form",{onSubmit:x(g),className:"p-6 bg-white rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6 text-center",children:"Service Information"}),e.jsxs("div",{className:"mb-4 flex flex-col lg:flex-row lg:space-x-4",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Vehicle Type"}),e.jsxs("select",{className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full",value:C.vehicle,onChange:a=>S(a.target.value,"vehicle"),children:[e.jsx("option",{value:"All",children:"All"}),(T=s==null?void 0:s.vehicleList)==null?void 0:T.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Select Service Category"}),e.jsxs("select",{className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full",value:C.category,onChange:a=>S(a.target.value,"category"),children:[e.jsx("option",{value:"All",children:"All"}),(E=s==null?void 0:s.categoryList)==null?void 0:E.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Service Name"}),e.jsxs("select",{...f("serviceID"),className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a service"}),s.filteredServiceList.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),l.serviceID&&e.jsx("p",{className:"text-red-600 text-sm",children:l.serviceID.message})]}),e.jsxs("div",{className:"mb-4 flex flex-col lg:flex-row lg:space-x-4",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Service Price"}),e.jsx("input",{type:"number",...f("price",{valueAsNumber:!0}),placeholder:"(i.e. 150)",className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full"}),l.price&&e.jsx("p",{className:"text-red-600 text-sm",children:l.price.message})]}),e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Discounted Price"}),e.jsx("input",{type:"number",...f("discPrice",{valueAsNumber:!0}),placeholder:"(i.e. 100)",className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full"}),l.discPrice&&e.jsx("p",{className:"text-red-600 text-sm",children:l.discPrice.message})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{children:"Service Addons"}),e.jsx(he,{className:"cursor-pointer hover:ring-2",onClick:()=>i({serviceID:"",price:0,discPrice:0})})]}),(c==null?void 0:c.length)>0&&e.jsx("div",{className:"rounded border p-2 my-2 px-4",children:c.map((a,o)=>{var z,$,q,V,H,M,U,G,O,B;return e.jsxs("div",{className:"mb-4 flex flex-col items-center lg:flex-row lg:space-x-4",children:[e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Service Name"}),e.jsxs("select",{...f(`addons.${o}.serviceID`),className:"mt-1 p-2 border border-gray-300 rounded-md",onChange:I=>d(I.target.value,o),children:[e.jsx("option",{value:"",disabled:!0,children:"Select a service"}),s.filteredAddonServiceList.map(I=>e.jsx("option",{value:I.id,disabled:D.includes(I.id),children:I.name},I.id))]}),(($=(z=l.addons)==null?void 0:z[o])==null?void 0:$.serviceID)&&e.jsx("p",{className:"text-red-600 text-sm",children:l.addons[o].serviceID.message})]}),e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Service Price"}),e.jsx("input",{type:"number",...f(`addons.${o}.price`,{valueAsNumber:!0}),placeholder:"(i.e. 150)",className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full"}),((V=(q=l.addons)==null?void 0:q[o])==null?void 0:V.price)&&e.jsx("p",{className:"text-red-600 text-sm",children:(M=(H=l.addons)==null?void 0:H[o])==null?void 0:M.price.message})]}),e.jsxs("div",{className:"flex-1 mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",children:"Discounted Price"}),e.jsx("input",{type:"number",...f(`addons.${o}.discPrice`,{valueAsNumber:!0}),placeholder:"(i.e. 150)",className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent focus:ring-2 focus:ring-black focus:outline-none w-full"}),((G=(U=l.addons)==null?void 0:U[o])==null?void 0:G.discPrice)&&e.jsx("p",{className:"text-red-600 text-sm",children:(B=(O=l.addons)==null?void 0:O[o])==null?void 0:B.discPrice.message})]}),e.jsx(ye,{className:"cursor-pointer hover:ring-2",onClick:()=>k(o)})]},a.id)})}),e.jsxs("div",{className:"flex items-center mb-4 lg:mb-0",children:[e.jsx("label",{className:"mt-1 py-2 rounded-md w-full",htmlFor:"isCustomizable",children:"Is Customizable"}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",...f("isCustomizable"),className:"mt-1 p-2 border border-gray-300 rounded-md focus:border-transparent hover:ring-2 focus:outline-none w-full"}),l.isCustomizable&&e.jsx("p",{className:"text-red-600 text-sm",children:l.isCustomizable.message})]})]}),e.jsx(K,{className:"mt-2 w-full",type:"submit",disabled:!A||!N||p,children:m===""?"Create New Service":"Update Service Details"})]})})}const Ae=({list:r,handleEdit:m,handleDelete:b,handleUpdate:u})=>e.jsx("div",{className:"overflow-x-auto overscroll-y-none",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 rounded-s py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"S.No."}),e.jsx("th",{className:"px-2 py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Service Name"}),e.jsx("th",{className:"px-2 py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Category"}),e.jsx("th",{className:"px-2 py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Vehicle Type"}),e.jsx("th",{className:"px-2 py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Price"}),e.jsx("th",{className:"px-2 py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Is Customizable"}),e.jsx("th",{className:"px-2 py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Status"}),e.jsx("th",{className:"px-2 rounded-e py-3 text-left font-bold text-xs text-white bg-black uppercase tracking-wider md:px-6",children:"Interact"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r==null?void 0:r.map((s,n)=>e.jsxs("tr",{className:"bg-gray-50 hover:bg-gray-100",children:[e.jsx("td",{className:"px-2 py-4 text-sm text-gray-900 md:px-6",children:n+1}),e.jsx("td",{className:"px-2 py-4 text-sm text-gray-900 md:px-6",children:s.serviceName}),e.jsx("td",{className:"px-2 py-4 text-sm text-center text-gray-900 md:px-6",children:s.categoryName}),e.jsx("td",{className:"px-2 py-4 text-sm text-center text-gray-900 md:px-6",children:s.vehicleName}),e.jsx("td",{className:"px-2 py-4 text-sm text-gray-900 md:px-6",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsxs("span",{className:"line-through text-red-500",children:["₹",s.price]}),e.jsxs("span",{className:"font-bold",children:["₹",s.discPrice,"/-"]})]})}),e.jsx("td",{className:"px-2 py-4 text-sm text-center text-gray-900 md:px-6",children:s.isCustomizable?"Yes":"No"}),e.jsx("td",{className:"px-2 py-4 text-sm text-center text-gray-900 md:px-6",children:s.isAvailable?"Active":"In-Active"}),e.jsx("td",{className:"px-2 py-4 text-sm text-gray-900 md:px-6",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{content:"Edit Center Details",trigger:e.jsx(fe,{className:"cursor-pointer rounded-md border p-1 bg-slate-400 hover:bg-slate-600 transition-all fade-in-100 text-black hover:text-white",size:"25",onClick:()=>m(s.id,"Edit Center Details")})}),e.jsx(F,{content:s.isAvailable?"InActivate Center":"Activate Center",trigger:s.isAvailable?e.jsx(ge,{className:"cursor-pointer rounded-md border p-1 bg-slate-400 hover:bg-slate-600 transition-all fade-in-100 text-black hover:text-white",size:"25",onClick:()=>u(s.id,!s.isAvailable)}):e.jsx(be,{className:"cursor-pointer rounded-md border p-1 bg-slate-400 hover:bg-slate-600 transition-all fade-in-100 text-black hover:text-white",size:"25",onClick:()=>u(s.id,!s.isAvailable)})}),e.jsx(F,{content:"Delete Center",trigger:e.jsx(ve,{className:"cursor-pointer rounded-md border p-1 bg-slate-400 hover:bg-slate-600 transition-all fade-in-100 text-black hover:text-white",size:"25",onClick:()=>b(s.id)})})]})})]},s.id))})]})});function We(){const{filteredList:r,handleConfirmation:m,modalToggle:b,searchTerm:u,selectedSort:s,setModalToggle:n,setSearchTerm:C,setSelectedSort:j,modalData:S,setModalData:f,handleServiceDeletion:y,handleServiceStatusUpdate:x}=we();function v(l,N){n(!0),f({id:l,title:N})}return e.jsxs(R,{fixed:!0,children:[e.jsx(R.Header,{children:e.jsxs("div",{className:"flex w-full items-center justify-end space-x-4",children:[e.jsx(_,{}),e.jsx(ee,{})]})}),e.jsxs(R.Body,{className:"flex flex-col",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Service List"}),e.jsx("p",{className:"text-muted-foreground",children:"View and manage all your services at one place."})]}),e.jsxs("div",{className:"my-4 flex items-end justify-between sm:my-0 sm:items-center",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:my-4 sm:flex-row",children:[e.jsx(ie,{placeholder:"Filter services...",className:"h-9 w-40 lg:w-[250px]",value:u,onChange:l=>C(l.target.value)}),e.jsxs(ce,{value:s,onValueChange:j,children:[e.jsx(ne,{className:"w-16",children:e.jsx(de,{children:e.jsx(Se,{size:18})})}),e.jsxs(oe,{align:"end",children:[e.jsx(Q,{value:"ascending",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(je,{size:16}),e.jsx("span",{children:"Ascending"})]})}),e.jsx(Q,{value:"descending",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ne,{size:16}),e.jsx("span",{children:"Descending"})]})})]})]})]}),e.jsxs(se,{open:b,onOpenChange:n,children:[e.jsx(te,{asChild:!0,children:e.jsx(K,{type:"button",onClick:()=>v("","Add New Service"),children:"Add New Service"})}),e.jsxs(ae,{className:"sm:max-w-[50vw]",children:[e.jsx(re,{children:e.jsx(le,{children:S.title})}),e.jsx(Le,{formID:S.id,handleConfirmation:()=>{m(),n(!1)}})]})]})]}),e.jsx(me,{className:"shadow"}),e.jsx(Ae,{list:r,handleDelete:y,handleUpdate:x,handleEdit:v})]})]})}export{We as default};
